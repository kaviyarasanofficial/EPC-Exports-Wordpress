(()=>{var e={184:(e,t)=>{var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var o=typeof a;if("string"===o||"number"===o)e.push(a);else if(Array.isArray(a)){if(a.length){var l=r.apply(null,a);l&&e.push(l)}}else if("object"===o){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){e.push(a.toString());continue}for(var s in a)n.call(a,s)&&a[s]&&e.push(s)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wp.apiFetch;var n=a.n(t),r=a(184),o=a.n(r);const l=window.React;function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s.apply(this,arguments)}var i,c;(c=i||(i={})).Pop="POP",c.Push="PUSH",c.Replace="REPLACE";const u="popstate";function d(e,t){if(!1===e||null==e)throw new Error(t)}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,a,n){return void 0===a&&(a=null),s({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?f(t):t,{state:a,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function h(e){let{pathname:t="/",search:a="",hash:n=""}=e;return a&&"?"!==a&&(t+="?"===a.charAt(0)?a:"?"+a),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function f(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substr(a),e=e.substr(0,a));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}var g;function y(e,t,a,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+a+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={})),new Set(["lazy","caseSensitive","path","id","index","children"]);const v=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",E=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;const w=["post","put","patch","delete"],k=(new Set(w),["get",...w]);function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},C.apply(this,arguments)}new Set(k),new Set([301,302,303,307,308]),new Set([307,308]),Symbol("deferred");const b=l.createContext(null),S=l.createContext(null),x=l.createContext(null),N=l.createContext({outlet:null,matches:[],isDataRoute:!1});function U(){return null!=l.useContext(x)}function R(){return U()||d(!1),l.useContext(x).location}function P(e){l.useContext(S).static||l.useLayoutEffect(e)}function L(){let{isDataRoute:e}=l.useContext(N);return e?function(){let{router:e}=function(e){let t=l.useContext(b);return t||d(!1),t}(O.UseNavigateStable),t=function(e){let t=function(e){let t=l.useContext(N);return t||d(!1),t}(),a=t.matches[t.matches.length-1];return a.route.id||d(!1),a.route.id}(T.UseNavigateStable),a=l.useRef(!1);return P((()=>{a.current=!0})),l.useCallback((function(n,r){void 0===r&&(r={}),a.current&&("number"==typeof n?e.navigate(n):e.navigate(n,C({fromRouteId:t},r)))}),[e,t])}():function(){U()||d(!1);let e=l.useContext(b),{basename:t,navigator:a}=l.useContext(S),{matches:n}=l.useContext(N),{pathname:r}=R(),o=JSON.stringify(function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(n).map((e=>e.pathnameBase))),i=l.useRef(!1);return P((()=>{i.current=!0})),l.useCallback((function(n,l){if(void 0===l&&(l={}),!i.current)return;if("number"==typeof n)return void a.go(n);let c=function(e,t,a,n){let r;void 0===n&&(n=!1),"string"==typeof e?r=f(e):(r=s({},e),d(!r.pathname||!r.pathname.includes("?"),y("?","pathname","search",r)),d(!r.pathname||!r.pathname.includes("#"),y("#","pathname","hash",r)),d(!r.search||!r.search.includes("#"),y("#","search","hash",r)));let o,l=""===e||""===r.pathname,i=l?"/":r.pathname;if(n||null==i)o=a;else{let e=t.length-1;if(i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let c=function(e,t){void 0===t&&(t="/");let{pathname:a,search:n="",hash:r=""}="string"==typeof e?f(e):e,o=a?a.startsWith("/")?a:function(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?a.length>1&&a.pop():"."!==e&&a.push(e)})),a.length>1?a.join("/"):"/"}(a,t):t;return{pathname:o,search:v(n),hash:E(r)}}(r,o),u=i&&"/"!==i&&i.endsWith("/"),m=(l||"."===i)&&a.endsWith("/");return c.pathname.endsWith("/")||!u&&!m||(c.pathname+="/"),c}(n,JSON.parse(o),r,"path"===l.relative);null==e&&"/"!==t&&(c.pathname="/"===c.pathname?t:[t,c.pathname].join("/").replace(/\/\/+/g,"/")),(l.replace?a.replace:a.push)(c,l.state,l)}),[t,a,o,r,e])}()}var O,T,A;function B(e){let{basename:t="/",children:a=null,location:n,navigationType:r=i.Pop,navigator:o,static:s=!1}=e;U()&&d(!1);let c=t.replace(/^\/*/,"/"),u=l.useMemo((()=>({basename:c,navigator:o,static:s})),[c,o,s]);"string"==typeof n&&(n=f(n));let{pathname:m="/",search:p="",hash:h="",state:g=null,key:y="default"}=n,v=l.useMemo((()=>{let e=function(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,n=e.charAt(a);return n&&"/"!==n?null:e.slice(a)||"/"}(m,c);return null==e?null:{location:{pathname:e,search:p,hash:h,state:g,key:y},navigationType:r}}),[c,m,p,h,g,y,r]);return null==v?null:l.createElement(S.Provider,{value:u},l.createElement(x.Provider,{children:a,value:v}))}l.Component,function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"}(O||(O={})),function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"}(T||(T={})),l.startTransition,function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(A||(A={})),new Promise((()=>{})),l.Component,new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const j=l.startTransition;function _(e){let{basename:t,children:a,future:n,window:r}=e,o=l.useRef();var c;null==o.current&&(o.current=(void 0===(c={window:r,v5Compat:!0})&&(c={}),function(e,t,a,n){void 0===n&&(n={});let{window:r=document.defaultView,v5Compat:o=!1}=n,l=r.history,c=i.Pop,f=null,g=y();function y(){return(l.state||{idx:null}).idx}function v(){c=i.Pop;let e=y(),t=null==e?null:e-g;g=e,f&&f({action:c,location:w.location,delta:t})}function E(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,a="string"==typeof e?e:h(e);return d(t,"No window.location.(origin|href) available to create URL for href: "+a),new URL(a,t)}null==g&&(g=0,l.replaceState(s({},l.state,{idx:g}),""));let w={get action(){return c},get location(){return e(r,l)},listen(e){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(u,v),f=e,()=>{r.removeEventListener(u,v),f=null}},createHref:e=>t(r,e),createURL:E,encodeLocation(e){let t=E(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){c=i.Push;let n=p(w.location,e,t);a&&a(n,e),g=y()+1;let s=m(n,g),u=w.createHref(n);try{l.pushState(s,"",u)}catch(e){if(e instanceof DOMException&&"DataCloneError"===e.name)throw e;r.location.assign(u)}o&&f&&f({action:c,location:w.location,delta:1})},replace:function(e,t){c=i.Replace;let n=p(w.location,e,t);a&&a(n,e),g=y();let r=m(n,g),s=w.createHref(n);l.replaceState(r,"",s),o&&f&&f({action:c,location:w.location,delta:0})},go:e=>l.go(e)};return w}((function(e,t){let{pathname:a="/",search:n="",hash:r=""}=f(e.location.hash.substr(1));return p("",{pathname:a,search:n,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let a=e.document.querySelector("base"),n="";if(a&&a.getAttribute("href")){let t=e.location.href,a=t.indexOf("#");n=-1===a?t:t.slice(0,a)}return n+"#"+("string"==typeof t?t:h(t))}),(function(e,t){!function(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),c)));let g=o.current,[y,v]=l.useState({action:g.action,location:g.location}),{v7_startTransition:E}=n||{},w=l.useCallback((e=>{E&&j?j((()=>v(e))):v(e)}),[v,E]);return l.useLayoutEffect((()=>g.listen(w)),[g,w]),l.createElement(B,{basename:t,children:a,location:y.location,navigationType:y.action,navigator:g})}var F,I;"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement,function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"}(F||(F={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(I||(I={}));const D=window.wp.components,M=({item:t,Components:a,methods:n,constants:r})=>{const o=e=>{e.data=e.data||{},e.data.page=window.location.href,n.apiFetch({url:`${r.resturl}${r.eventendpoint}`,method:"POST",data:e})},l=e=>{e.keycode&&ENTER!==e.keycode||o({action:"newfold-marketplaceitem-click",data:{element:"button",label:e.target.innerText,productId:t.id}})},s=e=>{e.keycode&&ENTER!==e.keycode||o({action:"newfold-marketplaceitem-click",data:{element:"a",href:e.target.getAttribute("href"),label:e.target.innerText,productId:t.id}})};return n.useEffect((()=>{const e=document.getElementById(`marketplace-item-${t.id}`),a=Array.from(e.querySelectorAll("button")),n=Array.from(e.querySelectorAll("a"));return a.length&&a.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.addEventListener("click",l),e.addEventListener("onkeydown",l))})),n.length&&n.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.addEventListener("click",s),e.addEventListener("onkeydown",s))})),()=>{a.length&&a.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.removeEventListener("click",l),e.removeEventListener("onkeydown",l))})),n.length&&n.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.removeEventListener("click",s),e.removeEventListener("onkeydown",s))}))}}),[]),(0,e.createElement)(a.Card,{className:`marketplace-item marketplace-item-${t.id} ${t.full_price?"product-has-full-price":""}`,id:`marketplace-item-${t.id}`},t.productThumbnailUrl&&(0,e.createElement)(a.CardMedia,null,(0,e.createElement)("img",{src:t.productThumbnailUrl,alt:t.name+" thumbnail"})),(0,e.createElement)(a.CardHeader,null,(0,e.createElement)("h2",null,t.name),(t=>{let a,n,r;return t.price>0&&t.price_formatted&&(n=(0,e.createElement)("div",{className:"price"},t.price_formatted),t.full_price>0&&t.full_price_formatted?(r=(0,e.createElement)("s",{className:"price full-price"},t.full_price_formatted),a=(0,e.createElement)("div",{className:"price-wrap has-full-price"},r,n)):a=(0,e.createElement)("div",{className:"price-wrap"},n)),a})(t)),t.description&&(0,e.createElement)(a.CardBody,{dangerouslySetInnerHTML:{__html:t.description}}),(0,e.createElement)(a.CardFooter,null,(t=>{let n,o;return t.primaryUrl&&t.primaryCallToAction&&(n=(0,e.createElement)(a.Button,{variant:"primary",className:"primary-cta",target:"_blank",href:t.primaryUrl,...r.supportsCTB&&t.clickToBuyId?{"data-action":"load-nfd-ctb","data-ctb-id":t.clickToBuyId}:{}},t.primaryCallToAction)),t.secondaryCallToAction&&t.secondaryUrl&&(o=(0,e.createElement)(a.Button,{variant:"secondary",className:"secondary-cta",target:"_blank",href:t.secondaryUrl},t.secondaryCallToAction)),(0,e.createElement)(e.Fragment,null,n,o)})(t)))},W=({marketplaceItems:t,currentCount:a,category:n,Components:r,methods:o,constants:l,saveCategoryDisplayCount:s})=>{const[i,c]=o.useState(a),[u,d]=o.useState([]),[m,p]=o.useState([]);return o.useEffect((()=>{d(((e,t)=>e.filter((e=>e.categories.includes(t.title))))(t,n))}),[]),o.useEffect((()=>{p(((e,t)=>{let a=0;return e.filter((e=>(a++,a<=t)))})(u,i))}),[u,i]),o.useEffect((()=>{s(n.name,i)}),[i]),(0,e.createElement)("div",{className:`marketplace-list marketplace-list-${n.name}`},(0,e.createElement)("div",{className:"grid col2"},m.length>0&&m.map((t=>(0,e.createElement)(M,{key:t.hash,item:t,Components:r,methods:o,constants:l}))),!m.length&&(0,e.createElement)("p",null,"Sorry, no marketplace items. Please, try again later.")),u&&u.length>i&&(0,e.createElement)("div",{style:{display:"flex",margin:"1rem 0"}},(0,e.createElement)(r.Button,{onClick:()=>{c(i+l.perPage)},variant:"primary",className:"align-center",style:{margin:"auto"}},"Load More")))},$=({width:t,height:a,customClass:n})=>(0,e.createElement)("div",{className:"newfold-marketplace-skeleton "+n,style:{width:t||"100%",height:a||"auto"}}),H=({width:t,height:a})=>(0,e.createElement)($,{width:t||"500px",height:a||"45px",customClass:"filterbar-skeleton"}),q=()=>(0,e.createElement)("div",{className:"marketplace-item-skeleton"},(0,e.createElement)("div",{className:"skeleton-item-media"},(0,e.createElement)($,{width:"100%",height:"auto",customClass:"marketplace-item-img-skeleton"})),(0,e.createElement)("div",{className:"skeleton-item-body"},(0,e.createElement)($,{width:"170px",height:"20px",customClass:"marketplace-item-title-skeleton"}),(0,e.createElement)($,{width:"100%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)($,{width:"100%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)($,{width:"70%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)($,{width:"80px",height:"36px",customClass:"marketplace-item-button-skeleton"}))),J=({items:t=6,filter:a=!0,containerClassNames:n="grid col2"})=>(0,e.createElement)("div",{className:"newfold-marketplace-isloading"},a&&(0,e.createElement)(H,null),(0,e.createElement)("div",{className:n},(t=>{const a=t;let n=[];for(let e=0;e<a;e++)n.push(e);return n.map((t=>(0,e.createElement)(q,{key:t})))})(t))),z=({methods:t,constants:a,Components:n,...r})=>{const[o,l]=t.useState(!0),[s,i]=t.useState(!1),[c,u]=t.useState([]),[d,m]=t.useState([]),[p,h]=t.useState(),f=t.useNavigate(),g=t.useLocation();t.useEffect((()=>{t.apiFetch({url:`${a.resturl}/newfold-marketplace/v1/marketplace`}).then((e=>{e.hasOwnProperty("categories")&&e.hasOwnProperty("products")?(m(e.products.data),u(y(e.categories.data))):i(!0)}))}),[]),t.useEffect((()=>{o||(d.length<1?i(!0):i(!1))}),[d]),t.useEffect((()=>{if(o&&c.length>1){if(g.pathname.includes("marketplace/")){const e=g.pathname.substring(g.pathname.lastIndexOf("/")+1);e&&0==c.filter((t=>t.name===e)).length?h(0):h(e)}l(!1),E()}}),[c]);const y=e=>{if(!e.length)return[];let t=[];return e.forEach((e=>{e.currentCount=a.perPage,e.className="newfold-marketplace-tab-"+e.name,e.products_count>0&&t.push(e)})),t},v=(e,t)=>{let a=[...c];a.forEach((a=>{a.name===e&&(a.currentCount=t)})),u(a)},E=()=>{c&&c.forEach((e=>{if(e.styles&&!document.querySelector('[data-styleid="'+e.className+'"]')){const t=document.createElement("style");t.textContent=e.styles,t.dataset.styleid=e.className,document.head.appendChild(t)}}))};return(0,e.createElement)("div",{className:t.classnames("newfold-marketplace-wrapper")},o&&(0,e.createElement)(J,null),s&&(0,e.createElement)("h3",null,"Oops, there was an error loading the marketplace, please try again later."),!o&&!s&&(0,e.createElement)(n.TabPanel,{className:"newfold-marketplace-tabs",activeClass:"current-tab",orientation:"horizontal",initialTabName:p,onSelect:e=>{f("/marketplace/"+e,{replace:!0})},tabs:c},(r=>(0,e.createElement)(W,{marketplaceItems:d,category:r,Components:n,methods:t,constants:a,currentCount:r.currentCount,saveCategoryDisplayCount:v}))))},V=()=>(0,e.createElement)(_,null,(0,e.createElement)("div",{className:"mojo-app"},(0,e.createElement)(z,{Components:{Button:D.Button,Card:D.Card,CardBody:D.CardBody,CardFooter:D.CardFooter,CardHeader:D.CardHeader,CardMedia:D.CardMedia,TabPanel:D.TabPanel,Spinner:D.Spinner},constants:{resturl:window.mojo.restUrl,eventendpoint:"/newfold-data/v1/events/",perPage:12,supportsCTB:!1},methods:{apiFetch:n(),classnames:o(),useEffect:l.useEffect,useState:e.useState,useNavigate:L,useLocation:R}}))),G=window.wp.domReady;a.n(G)()((()=>(0,e.render)((0,e.createElement)(V,null),document.getElementById("mojo-marketplace-app"))))})()})();